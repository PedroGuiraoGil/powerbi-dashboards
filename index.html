<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pedro Guirao Gil - Analista de Datos y Novelista</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: radial-gradient(circle at 20% 50%, #ff6b6b 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, #4ecdc4 0%, transparent 50%),
                        radial-gradient(circle at 40% 80%, #45b7d1 0%, transparent 50%),
                        linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-size: 400% 400%;
            animation: backgroundShift 15s ease infinite;
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        @keyframes backgroundShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 60px;
            padding-top: 40px;
        }

        .profile-section h1 {
            font-size: 3.5rem;
            margin-bottom: 20px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #ff6b6b);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 4s ease-in-out infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .profile-info p {
            font-size: 1.3rem;
            opacity: 0.95;
        }

        .profile-info .highlight-text {
            font-size: 1.3rem;
            opacity: 0.95;
        }

        .highlight-text .part {
            padding: 2px 8px;
            border-radius: 15px;
            transition: all 0.5s ease;
            display: inline-block;
            margin: 0 2px;
        }

        .highlight-text .part.highlight {
            background: linear-gradient(45deg, rgba(255,107,107,0.8), rgba(78,205,196,0.8));
            color: white;
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            font-weight: bold;
        }

        .section-tabs {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.2);
            color: white;
            backdrop-filter: blur(10px);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .tab-button.active {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .tab-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }

        .section-content {
            display: none;
            animation: fadeInUp 0.6s ease-out;
        }

        .section-content.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .nav-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin: 60px 0;
            padding: 20px;
        }

        .modern-nav-button {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            padding: 25px;
            border-radius: 20px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-size: 1rem;
            min-height: 80px;
            transition: all 0.4s ease;
            color: white;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.5);
        }

        .modern-nav-button:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .btn-ventas {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .btn-futbol {
            background: linear-gradient(135deg, #1e3a2e 0%, #0f2419 100%);
        }

        .btn-presencia {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .btn-coches {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #333 !important;
            text-shadow: 1px 1px 4px rgba(255,255,255,0.8) !important;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 40px;
            margin-bottom: 60px;
        }

        .dashboard-card {
            background: rgba(255,255,255,0.95);
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            transition: all 0.4s ease;
            cursor: pointer;
            border: 3px solid transparent;
        }

        .dashboard-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: 0 35px 70px rgba(0,0,0,0.25);
            border-color: rgba(255,107,107,0.5);
        }

        .card-image {
            width: 100%;
            height: 300px;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .dashboard-card:hover .card-image img {
            transform: scale(1.05);
        }

        .card-content {
            padding: 30px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: #333;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .status-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            text-transform: uppercase;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            color: white;
            background: linear-gradient(45deg, #28a745, #20c997);
        }

        .card-description {
            color: #666;
            margin-bottom: 25px;
            line-height: 1.8;
            font-size: 1.1rem;
        }

        .view-button {
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .view-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

        .info-section {
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 50px;
            margin-top: 80px;
            color: white;
            border: 2px solid rgba(255,255,255,0.2);
            box-shadow: 0 25px 50px rgba(0,0,0,0.1);
        }

        .info-section h2 {
            margin-bottom: 30px;
            font-size: 2.2rem;
            text-align: center;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #ff6b6b);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 4s ease-in-out infinite;
            font-weight: bold;
        }

        .info-text {
            font-size: 1.2rem;
            line-height: 1.8;
            text-align: center;
            opacity: 0.9;
        }

        .books-section {
            background: rgba(255,255,255,0.95);
            border-radius: 30px;
            padding: 50px;
            margin: 40px 0;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }

        .books-title {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #9B59B6, #8E44AD, #6C3483);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: bold;
            text-align: center;
        }

        .books-subtitle {
            font-size: 1.2rem;
            color: #666;
            line-height: 1.6;
            margin-bottom: 30px;
            text-align: center;
        }

        .books-carousel {
            position: relative;
            height: 450px;
            margin: 40px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .books-container {
            position: relative;
            width: 900px;
            height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .book-cover {
            position: absolute;
            width: 220px;
            height: 330px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            transition: all 0.8s ease;
            cursor: pointer;
            overflow: hidden;
        }

        .book-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 15px;
        }

        .book-cover.active {
            z-index: 6;
            transform: scale(1.15);
            box-shadow: 0 30px 60px rgba(0,0,0,0.4);
        }

        .book-cover.prev {
            z-index: 3;
            transform: scale(0.85) translateX(-180px);
            opacity: 0.7;
        }

        .book-cover.next {
            z-index: 3;
            transform: scale(0.85) translateX(180px);
            opacity: 0.7;
        }

        .book-cover.hidden {
            z-index: 0;
            transform: scale(0.5) translateX(-400px);
            opacity: 0;
        }

        .book-cover.hidden-next {
            z-index: 0;
            transform: scale(0.5) translateX(400px);
            opacity: 0;
        }

        .book-info {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            border: 2px solid rgba(142,68,173,0.2);
            min-height: 220px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .book-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #8E44AD, #9B59B6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .book-author {
            font-size: 1.1rem;
            color: #6C3483;
            font-style: italic;
            margin-bottom: 20px;
        }

        .book-description {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #666;
            margin-bottom: 25px;
            text-align: justify;
        }

        .book-genre {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 20px;
            color: white;
        }

        .book-links-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .book-link {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            color: white;
            text-decoration: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            border: none;
        }

        .book-link:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

        .carousel-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin-top: 30px;
        }

        .nav-button {
            background: linear-gradient(45deg, #8E44AD, #9B59B6);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 25px rgba(142,68,173,0.3);
        }

        .nav-button:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 35px rgba(142,68,173,0.5);
        }

        .indicators {
            display: flex;
            gap: 12px;
        }

        .indicator {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: rgba(142,68,173,0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .indicator.active {
            background: #8E44AD;
            transform: scale(1.2);
        }

        .autoplay-control {
            text-align: center;
            margin-top: 20px;
        }

        .autoplay-btn {
            background: rgba(255,255,255,0.2);
            color: #8E44AD;
            border: 2px solid #8E44AD;
            border-radius: 25px;
            padding: 10px 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .autoplay-btn:hover {
            background: #8E44AD;
            color: white;
        }

        .video-modal, .gallery-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            padding: 20px;
        }

        .video-content, .gallery-content {
            max-width: 90vw;
            max-height: 90vh;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            margin: auto;
            top: 50%;
            transform: translateY(-50%);
        }

        .video-header, .gallery-header {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .video-title, .gallery-title {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .close-video, .close-gallery {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            font-size: 1.5rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .video-player {
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: #000;
            min-height: 400px;
        }

        .video-player video {
            width: 100%;
            max-width: 800px;
            height: auto;
            border-radius: 10px;
            background: #000;
        }

        .video-fallback {
            color: white;
            text-align: center;
            padding: 40px;
            font-size: 1.2rem;
            background: #333;
            border-radius: 10px;
            margin: 20px;
            max-width: 800px;
        }

        .video-fallback a {
            color: #4ecdc4;
            text-decoration: none;
            font-weight: bold;
        }

        .video-fallback a:hover {
            text-decoration: underline;
        }

        .gallery-images {
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .gallery-image {
            position: relative;
            cursor: pointer;
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .gallery-image:hover {
            transform: scale(1.03);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .gallery-image img {
            width: 100%;
            height: auto;
            display: block;
            transition: transform 0.3s ease;
        }

        .gallery-image:hover img {
            transform: scale(1.05);
        }

        .image-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,107,107,0.9), rgba(78,205,196,0.9));
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: all 0.3s ease;
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-align: center;
        }

        .gallery-image:hover .image-overlay {
            opacity: 1;
        }

        /* Modal para imagen ampliada */
        .image-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 1100;
            padding: 20px;
            align-items: center;
            justify-content: center;
        }

        .image-modal-content {
            position: relative;
            max-width: 95vw;
            max-height: 95vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .image-modal img {
            max-width: 100%;
            max-height: 85vh;
            border-radius: 15px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            object-fit: contain;
        }

        .image-modal-header {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            padding: 15px 30px;
            border-radius: 25px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            letter-spacing: 0.5px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .image-modal-close {
            position: absolute;
            top: -15px;
            right: -15px;
            background: rgba(255,255,255,0.9);
            border: none;
            color: #333;
            font-size: 1.8rem;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .image-modal-close:hover {
            background: #ff6b6b;
            color: white;
            transform: scale(1.1);
        }

        .image-navigation {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            align-items: center;
        }

        .image-nav-btn {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-nav-btn:hover:not(:disabled) {
            transform: scale(1.1);
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
        }

        .image-nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Flechas laterales para navegación directa */
        .side-nav-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(45deg, rgba(255,107,107,0.9), rgba(78,205,196,0.9));
            color: white;
            border: none;
            border-radius: 50%;
            width: 70px;
            height: 70px;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.3);
        }

        .side-nav-arrow:hover:not(:disabled) {
            transform: translateY(-50%) scale(1.15);
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
        }

        .side-nav-arrow:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            transform: translateY(-50%) scale(0.8);
        }

        .side-nav-arrow.left {
            left: 30px;
        }

        .side-nav-arrow.right {
            right: 30px;
        }

        /* Efecto hover para mostrar las flechas más claramente */
        .image-modal-content:hover .side-nav-arrow:not(:disabled) {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
        }

        .image-modal-content .side-nav-arrow {
            opacity: 0.7;
        }

        .image-counter {
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            padding: 10px 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        @media (max-width: 768px) {
            .profile-section h1 {
                font-size: 2.5rem;
            }
            
            .nav-links {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .section-tabs {
                flex-direction: column;
                align-items: center;
            }

            .tab-button {
                width: 250px;
            }

            .books-container {
                width: 100%;
            }
            
            .book-cover {
                width: 150px;
                height: 225px;
            }
            
            .book-cover.prev, .book-cover.next {
                transform: scale(0.8) translateX(-100px);
            }
            
            .book-cover.next {
                transform: scale(0.8) translateX(100px);
            }

            .book-info {
                padding: 20px;
            }

            .book-title {
                font-size: 1.5rem;
            }

            /* Ajustes para flechas laterales en móvil */
            .side-nav-arrow {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }

            .side-nav-arrow.left {
                left: 15px;
            }

            .side-nav-arrow.right {
                right: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="profile-section">
                <h1>Pedro Guirao Gil</h1>
                <div class="profile-info">
                    <div class="highlight-text">
                        <span class="part" data-part="0">Especialista en Power BI y Microsoft Excel</span>
                        <span> • </span>
                        <span class="part" data-part="1">Formador</span>
                        <span> • </span>
                        <span class="part" data-part="2">Consultor</span>
                        <span> • </span>
                        <span class="part" data-part="3">Novelista</span>
                    </div>
                </div>
            </div>
            
            <div class="section-tabs">
                <button class="tab-button active" onclick="showSection('dashboards'); return false;">
                    📊 DASHBOARDS POWER BI
                </button>
                <button class="tab-button" onclick="showSection('books'); return false;">
                    📚 MIS NOVELAS
                </button>
            </div>
        </div>

        <!-- Sección de Dashboards -->
        <div id="dashboards" class="section-content active">
            <div class="nav-links">
                <a href="https://app.powerbi.com/view?r=eyJrIjoiYTJjN2E3MjAtZDdhMC00NmE5LThhZmEtMjU1MzA1ZDAzZDI2IiwidCI6IjgxNTAwZjZkLWJjZTktNDgzNC1iNDQ2LTc0YjVmYjljZjEwZSIsImMiOjh9" target="_blank" class="modern-nav-button btn-ventas">
                    📊 ANÁLISIS DE VENTAS
                </a>
                <a href="https://app.powerbi.com/view?r=eyJrIjoiMGRlZjM5MjQtYjE0MC00MWMwLTllNjQtYmYwMTFlN2Y2NWE2IiwidCI6IjgxNTAwZjZkLWJjZTktNDgzNC1iNDQ2LTc0YjVmYjljZjEwZSIsImMiOjh9" target="_blank" class="modern-nav-button btn-futbol">
                    ⚽ LIGA DE FÚTBOL
                </a>
                <a href="https://app.powerbi.com/view?r=eyJrIjoiNDVlNWVhZGEtZjNjYi00NmM4LTg2NzEtMDQzZDNkY2YzMmE5IiwidCI6IjgxNTAwZjZkLWJjZTktNDgzNC1iNDQ2LTc0YjVmYjljZjEwZSIsImMiOjh9&pageName=ReportSection" target="_blank" class="modern-nav-button btn-presencia">
                    📅 CONTROL DE PRESENCIA
                </a>
                <a href="https://app.powerbi.com/view?r=eyJrIjoiMmIwNDBjZjItNWJmMi00OWFlLWI4OWEtZmJhY2QwN2M4NjMwIiwidCI6IjgxNTAwZjZkLWJjZTktNDgzNC1iNDQ2LTc0YjVmYjljZjEwZSIsImMiOjh9" target="_blank" class="modern-nav-button btn-coches">
                    🚗 ALQUILER DE COCHES
                </a>
            </div>

            <div class="dashboard-grid">
                <div class="dashboard-card" onclick="openGallery('ventas')">
                    <div class="card-image">
                        <img src="https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/ventas1.jpg" alt="Dashboard de Ventas" onerror="this.src='https://placehold.co/600x400/ff6b6b/ffffff?text=Ventas'">
                    </div>
                    <div class="card-content">
                        <div class="card-header">
                            <h3 class="card-title">📊 Análisis de Ventas</h3>
                            <span class="status-badge">Legacy Público</span>
                        </div>
                        <p class="card-description">
                            Dashboard completo de análisis de ventas con KPIs principales, evolución temporal y segmentación detallada. <strong>3 páginas interactivas</strong> con métricas de performance comercial.
                        </p>
                        <button class="view-button" onclick="openGallery('ventas')" style="background: linear-gradient(45deg, #667eea, #764ba2);">
                            📊 Ver todas las páginas (3)
                        </button>
                    </div>
                </div>

                <div class="dashboard-card" onclick="openGallery('futbol')">
                    <div class="card-image">
                        <img src="https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/futbol1.jpg" alt="Dashboard de Fútbol" onerror="this.src='https://placehold.co/600x400/4ecdc4/ffffff?text=Futbol'">
                    </div>
                    <div class="card-content">
                        <div class="card-header">
                            <h3 class="card-title">⚽ Liga de Fútbol</h3>
                            <span class="status-badge">Legacy Público</span>
                        </div>
                        <p class="card-description">
                            Análisis estadístico completo de liga de fútbol con clasificaciones, estadísticas de jugadores y equipos. <strong>2 páginas interactivas</strong> con métricas deportivas avanzadas.
                        </p>
                        <button class="view-button" onclick="openGallery('futbol')" style="background: linear-gradient(45deg, #1e3a2e, #0f2419);">
                            ⚽ Ver todas las páginas (2)
                        </button>
                    </div>
                </div>

                <div class="dashboard-card" onclick="openGallery('presencia')">
                    <div class="card-image">
                        <img src="https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/bajas1.jpg" alt="Dashboard de Presencia" onerror="this.src='https://placehold.co/600x400/96ceb4/ffffff?text=Presencia'">
                    </div>
                    <div class="card-content">
                        <div class="card-header">
                            <h3 class="card-title">📅 Control de Presencia</h3>
                            <span class="status-badge">Legacy Público</span>
                        </div>
                        <p class="card-description">
                            Control completo de presencia, entradas, salidas, vacaciones y bajas del personal. <strong>2 páginas interactivas</strong> con gestión de recursos humanos y calendarios.
                        </p>
                        <button class="view-button" onclick="openGallery('presencia')" style="background: linear-gradient(45deg, #f093fb, #f5576c);">
                            🕐 Ver todas las páginas (2)
                        </button>
                    </div>
                </div>

                <div class="dashboard-card" onclick="openGallery('coches')">
                    <div class="card-image">
                        <img src="https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/alquiler1.jpg" alt="Dashboard de Alquiler" onerror="this.src='https://placehold.co/600x400/fd7e14/ffffff?text=Coches'">
                    </div>
                    <div class="card-content">
                        <div class="card-header">
                            <h3 class="card-title">🚗 Alquiler de Coches</h3>
                            <span class="status-badge">Legacy Público</span>
                        </div>
                        <p class="card-description">
                            Dashboard de análisis de alquiler de vehículos con métricas de rentabilidad, ocupación y tendencias del mercado. <strong>4 páginas interactivas</strong> con KPIs del sector automovilístico.
                        </p>
                        <button class="view-button" onclick="openGallery('coches')" style="background: linear-gradient(45deg, #ffecd2, #fcb69f); color: #333;">
                            🚗 Ver todas las páginas (4)
                        </button>
                    </div>
                </div>
            </div>

            <div class="info-section">
                <h2>🎯 Sobre estos Dashboards</h2>
                <p class="info-text">
                    Estos dashboards representan casos reales de implementación de Power BI en diferentes sectores: 
                    comercial, deportivo, recursos humanos y automovilístico. Todos mantienen acceso público 
                    como ejemplos legacy, ideales para demos comerciales y formación especializada en análisis de datos.
                </p>
            </div>
        </div>

        <!-- Sección de Libros -->
        <div id="books" class="section-content">
            <div class="books-section">
                <h2 class="books-title">📚 Mi Faceta Literaria</h2>
                <p class="books-subtitle">
                    Exploro mundos imaginarios a través de la escritura, desde la ciencia ficción hasta el thriller, 
                    siempre buscando conectar con los lectores a través de historias que combinan entretenimiento y reflexión.
                </p>

                <div class="books-carousel">
                    <div class="books-container">
                        <div class="book-cover active" data-index="0" onclick="goToBook(0)">
                            <img src="https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/FIN.png" alt="FIN - Pedro G. Guirao" onerror="this.src='https://placehold.co/220x330/FF6B6B/ffffff?text=FIN'">
                        </div>
                        <div class="book-cover next" data-index="1" onclick="goToBook(1)">
                            <img src="https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/OH%20MY%20GOD.jpg" alt="OH MY GOD - Pedro G. Guirao" onerror="this.src='https://placehold.co/220x330/FF8E53/ffffff?text=OMG'">
                        </div>
                        <div class="book-cover hidden" data-index="2" onclick="goToBook(2)">
                            <img src="https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/MANUAL%20BASICO%20DE%20CONQUISTA.jpg" alt="MANUAL BÁSICO DE CONQUISTA - Pedro G. Guirao" onerror="this.src='https://placehold.co/220x330/FFA726/ffffff?text=Manual'">
                        </div>
                        <div class="book-cover hidden" data-index="3" onclick="goToBook(3)">
                            <img src="https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/TOCATA%20Y%20FUGA%20DE%20LA%20TENIENTE%20ESCALI.jpg" alt="TOCATA Y FUGA DE LA TENIENTE ESCALI - Pedro G. Guirao" onerror="this.src='https://placehold.co/220x330/4ECDC4/ffffff?text=TOCATA'">
                        </div>
                        <div class="book-cover hidden" data-index="4" onclick="goToBook(4)">
                            <img src="https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/ESCALIS%20BLUES.jpg" alt="ESCALI'S BLUES - Pedro G. Guirao" onerror="this.src='https://placehold.co/220x330/26A69A/ffffff?text=BLUES'">
                        </div>
                        <div class="book-cover hidden" data-index="5" onclick="goToBook(5)">
                            <img src="https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/EXODOS.jpg" alt="ÉXODOS - Kia P. Cabdill" onerror="this.src='https://placehold.co/220x330/8E44AD/ffffff?text=ÉXODOS'">
                        </div>
                    </div>
                </div>

                <div class="book-info" id="bookInfo">
                    <h3 class="book-title" id="bookTitle"></h3>
                    <p class="book-author" id="bookAuthor"></p>
                    <p class="book-description" id="bookDescription"></p>
                    <span class="book-genre" id="bookGenre"></span>
                    <div class="book-links-container">
                        <a href="#" target="_blank" class="book-link" id="bookLink">
                            <span>📖</span> Ver en Amazon
                        </a>
                        <button class="book-link" id="bookTrailerLink" style="display: none; background: #c0392b;">
                            <span>🎬</span> Ver Booktrailer
                        </button>
                        <button class="book-link" id="bookTrailerLink2" style="display: none; background: #8b0000;">
                            <span>🎥</span> Ver Booktrailer 2
                        </button>
                    </div>
                </div>

                <div class="carousel-controls">
                    <button class="nav-button" onclick="prevBook()">←</button>
                    <div class="indicators" id="indicators"></div>
                    <button class="nav-button" onclick="nextBook()">→</button>
                </div>

                <div class="autoplay-control">
                    <button class="autoplay-btn" onclick="toggleAutoplay()" id="autoplayBtn">⏸️ Pausar Carrusel</button>
                </div>
            </div>
        </div>

        <!-- Modal de Video -->
        <div id="videoModal" class="video-modal">
            <div class="video-content">
                <div class="video-header">
                    <h3 class="video-title" id="videoTitle">🎬 Booktrailer</h3>
                    <button class="close-video" onclick="closeVideo()">✕</button>
                </div>
                <div class="video-player">
                    <video id="videoPlayer" controls preload="metadata" style="max-width: 100%; height: auto;">
                        <source id="videoSource" src="" type="video/mp4">
                        <source id="videoSourceWebm" src="" type="video/webm">
                        <source id="videoSourceOgv" src="" type="video/ogg">
                        Tu navegador no soporta el elemento de video.
                    </video>
                    <div id="videoFallback" class="video-fallback" style="display: none;">
                        <p>🎬 Video no disponible para reproducción web</p>
                        <p>Este video tiene un formato que no es compatible con la reproducción directa en navegadores.</p>
                        <p>Puedes <a id="videoDownloadLink" href="#" download>⬇️ descargar el video aquí</a> para verlo en tu reproductor favorito</p>
                        <p><small>O intenta abrirlo en una nueva pestaña: <a id="videoDirectLink" href="#" target="_blank">🔗 Enlace directo</a></small></p>
                        <p><small><em>Nota: Algunos videos están optimizados para descarga y no para streaming web</em></small></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal de Galería -->
        <div id="galleryModal" class="gallery-modal">
            <div class="gallery-content">
                <div class="gallery-header">
                    <h3 id="galleryTitle" class="gallery-title"></h3>
                    <button class="close-gallery" onclick="closeGallery()">✕</button>
                </div>
                <div id="galleryImages" class="gallery-images"></div>
            </div>
        </div>

        <!-- Modal para imagen ampliada -->
        <div id="imageModal" class="image-modal">
            <div class="image-modal-content">
                <div class="image-modal-header" id="imageModalTitle"></div>
                <div style="position: relative;">
                    <img id="imageModalImg" src="" alt="">
                    <button class="image-modal-close" onclick="closeImageModal()">✕</button>
                    
                    <!-- Flechas laterales para navegación directa -->
                    <button class="side-nav-arrow left" id="sideNavLeft" onclick="navigateImage(-1)">‹</button>
                    <button class="side-nav-arrow right" id="sideNavRight" onclick="navigateImage(1)">›</button>
                </div>
                <div class="image-navigation">
                    <button class="image-nav-btn" id="prevImageBtn" onclick="navigateImage(-1)">←</button>
                    <div class="image-counter" id="imageCounter"></div>
                    <button class="image-nav-btn" id="nextImageBtn" onclick="navigateImage(1)">→</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales - declaradas una sola vez
        var currentBook = 0;
        var autoplayInterval;
        var isAutoplayActive = true;
        var totalBooks = 6;
        var currentGallery = null;
        var currentImageIndex = 0;

        // Datos de dashboards
        var dashboards = {
            ventas: {
                images: [
                    "https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/ventas1.jpg",
                    "https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/ventas2.jpg",
                    "https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/ventas3.jpg"
                ]
            },
            futbol: {
                images: [
                    "https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/futbol1.jpg",
                    "https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/futbol2.jpg"
                ]
            },
            presencia: {
                images: [
                    "https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/bajas1.jpg",
                    "https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/bajas2.jpg"
                ]
            },
            coches: {
                images: [
                    "https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/alquiler1.jpg",
                    "https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/alquiler2.jpg",
                    "https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/alquiler3.jpg",
                    "https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/alquiler4.jpg"
                ]
            }
        };

        // Datos de libros
        var booksData = [
            { 
                title: "FIN", 
                author: "Por Pedro G. Guirao", 
                description: "Una reflexión profunda sobre los límites de la existencia humana y el significado del final. Una obra que explora las grandes preguntas filosóficas a través de una narrativa envolvente.", 
                genre: "Ficción Filosófica", 
                genreColor: "linear-gradient(45deg, #FF6B6B, #FF8E53)", 
                link: "https://www.amazon.es/Fin-Pedro-G-Guirao-ebook/dp/B0DYK9VBMS/", 
                linkColor: "linear-gradient(45deg, #FF6B6B, #FF8E53)" 
            },
            { 
                title: "OH MY GOD", 
                author: "Por Pedro G. Guirao", 
                description: "La Biblia Apócrifa del FIN de los días. Primera obra del autor. Creada con la misma edad de Cristo en la Cruz. Cuentos de apariencia inconexa y de aspecto bíblico mesiánico.", 
                genre: "Ficción Filosófica", 
                genreColor: "linear-gradient(45deg, #FF8E53, #FFA726)", 
                link: "https://www.kobo.com/es/es/search?query=pedro+g+guirao", 
                linkColor: "linear-gradient(45deg, #FF8E53, #FFA726)" 
            },
            { 
                title: "MANUAL BÁSICO DE CONQUISTA", 
                author: "Por Pedro G. Guirao", 
                description: "Una sátira inteligente sobre las relaciones humanas y los juegos de poder en la sociedad moderna. Con humor filosófico, disecciona los mecanismos de seducción, manipulación y conquista.", 
                genre: "Ficción Filosófica", 
                genreColor: "linear-gradient(45deg, #FFA726, #FFB74D)", 
                link: "https://www.amazon.es/Manual-B%C3%A1sico-Conquista-Pedro-Guirao-ebook/dp/B0DWXRXMLV/", 
                linkColor: "linear-gradient(45deg, #FFA726, #FFB74D)" 
            },
            { 
                title: "TOCATA Y FUGA DE LA TENIENTE ESCALI", 
                author: "Por Pedro G. Guirao", 
                description: "El debut de la Teniente Escali en un thriller que combina suspense policial con profundas reflexiones existenciales. Una investigación criminal se convierte en un viaje hacia los abismos del alma humana.", 
                genre: "Thriller Existencialista", 
                genreColor: "linear-gradient(45deg, #4ECDC4, #26A69A)", 
                link: "https://www.amazon.es/s?k=TOCATA+Y+FUGA+DE+LA+TENIENTE+ESCALI", 
                linkColor: "linear-gradient(45deg, #4ECDC4, #26A69A)", 
                trailer: "https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/BOOKTRAILER%20VIDEOS%20ESCALI.mp4?v=1",
                trailer2: "https://raw.githubusercontent.com/PedroGuiraoGil/powerbi-dashboards/main/images/BOOKTRAILER-2-ESCALI.mp4?v=1" 
            },
            { 
                title: "ESCALI'S BLUES", 
                author: "Por Pedro G. Guirao", 
                description: "La secuela que profundiza en el universo de la Teniente Escali. Más oscura y compleja que su predecesora, esta obra explora los traumas del pasado mientras enfrenta un nuevo caso.", 
                genre: "Thriller Existencialista", 
                genreColor: "linear-gradient(45deg, #26A69A, #00897B)", 
                link: "https://www.kobo.com/es/es/search?query=pedro+g+guirao", 
                linkColor: "linear-gradient(45deg, #26A69A, #00897B)" 
            },
            { 
                title: "ÉXODOS", 
                author: "Por Kia P. Cabdill", 
                description: "Una épica space opera que narra el destino de la humanidad en su búsqueda de nuevos mundos. Cuando la Tierra se vuelve inhabitable, flotas de refugiados espaciales emprenden un viaje desesperado hacia lo desconocido.", 
                genre: "Space Opera - Ciencia Ficción", 
                genreColor: "linear-gradient(45deg, #8E44AD, #9B59B6)", 
                link: "https://www.amazon.es/s?i=digital-text&rh=p_27%3AKia%2BP.%2BCabdill", 
                linkColor: "linear-gradient(45deg, #8E44AD, #9B59B6)" 
            }
        ];

        // Función para cambiar secciones
        function showSection(sectionName) {
            // Obtener el evento actual
            var clickedButton = event ? event.currentTarget : null;
            
            var sections = document.querySelectorAll('.section-content');
            var buttons = document.querySelectorAll('.tab-button');
            
            sections.forEach(function(section) {
                section.classList.remove('active');
            });
            
            buttons.forEach(function(button) {
                button.classList.remove('active');
            });
            
            var targetSection = document.getElementById(sectionName);
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            if (clickedButton) {
                clickedButton.classList.add('active');
            }
        }

        // Funciones de galería de dashboards
        function openGallery(dashboardKey) {
            var titleMap = {
                ventas: "📊 Análisis de Ventas - Dashboard Completo",
                futbol: "⚽ Liga de Fútbol - Estadísticas Deportivas",
                presencia: "📅 Control de Presencia - Gestión de Personal",
                coches: "🚗 Alquiler de Coches - Análisis del Sector Automovilístico"
            };
            
            var dashboard = dashboards[dashboardKey];
            if (!dashboard) return;

            currentGallery = dashboard.images;
            var modal = document.getElementById('galleryModal');
            var title = document.getElementById('galleryTitle');
            var imagesContainer = document.getElementById('galleryImages');

            title.textContent = titleMap[dashboardKey];
            imagesContainer.innerHTML = '';
            
            dashboard.images.forEach(function(imageSrc, index) {
                var imageWrapper = document.createElement('div');
                imageWrapper.className = 'gallery-image';
                imageWrapper.onclick = function() { openImageModal(index, titleMap[dashboardKey]); };
                
                var img = document.createElement('img');
                img.src = imageSrc;
                img.alt = title.textContent + ' - Página ' + (index + 1);
                
                var overlay = document.createElement('div');
                overlay.className = 'image-overlay';
                overlay.innerHTML = '🔍 Ver ampliada<br>Página ' + (index + 1);
                
                imageWrapper.appendChild(img);
                imageWrapper.appendChild(overlay);
                imagesContainer.appendChild(imageWrapper);
            });

            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeGallery() {
            var modal = document.getElementById('galleryModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            currentGallery = null;
        }

        // Funciones para modal de imagen ampliada
        function openImageModal(imageIndex, galleryTitle) {
            if (!currentGallery || !currentGallery[imageIndex]) return;
            
            currentImageIndex = imageIndex;
            var modal = document.getElementById('imageModal');
            var img = document.getElementById('imageModalImg');
            var title = document.getElementById('imageModalTitle');
            var counter = document.getElementById('imageCounter');
            var prevBtn = document.getElementById('prevImageBtn');
            var nextBtn = document.getElementById('nextImageBtn');
            var sideNavLeft = document.getElementById('sideNavLeft');
            var sideNavRight = document.getElementById('sideNavRight');
            
            img.src = currentGallery[imageIndex];
            img.alt = galleryTitle + ' - Página ' + (imageIndex + 1);
            title.textContent = galleryTitle + ' - Página ' + (imageIndex + 1);
            counter.textContent = (imageIndex + 1) + ' de ' + currentGallery.length;
            
            // Habilitar/deshabilitar botones de navegación (inferiores)
            prevBtn.disabled = imageIndex === 0;
            nextBtn.disabled = imageIndex === currentGallery.length - 1;
            
            // Habilitar/deshabilitar flechas laterales
            sideNavLeft.disabled = imageIndex === 0;
            sideNavRight.disabled = imageIndex === currentGallery.length - 1;
            
            modal.style.display = 'flex';
        }

        function closeImageModal() {
            var modal = document.getElementById('imageModal');
            modal.style.display = 'none';
        }

        function navigateImage(direction) {
            var newIndex = currentImageIndex + direction;
            if (newIndex >= 0 && newIndex < currentGallery.length) {
                var galleryTitle = document.getElementById('galleryTitle').textContent;
                openImageModal(newIndex, galleryTitle);
            }
        }

        // Funciones de libros
        function updateBookInfo() {
            var currentBookData = booksData[currentBook];
            if (!currentBookData) return;

            document.getElementById('bookTitle').textContent = currentBookData.title;
            document.getElementById('bookAuthor').textContent = currentBookData.author;
            document.getElementById('bookDescription').textContent = currentBookData.description;
            
            var genreEl = document.getElementById('bookGenre');
            genreEl.textContent = currentBookData.genre;
            genreEl.style.background = currentBookData.genreColor;
            
            var linkEl = document.getElementById('bookLink');
            linkEl.href = currentBookData.link;
            linkEl.style.background = currentBookData.linkColor;
            
            var trailerLinkEl = document.getElementById('bookTrailerLink');
            var trailerLinkEl2 = document.getElementById('bookTrailerLink2');
            
            if (currentBookData.trailer) {
                trailerLinkEl.onclick = function(e) {
                    e.preventDefault();
                    openVideo(currentBookData.trailer, currentBookData.title + ' - Booktrailer Original');
                };
                trailerLinkEl.style.display = 'inline-flex';
            } else {
                trailerLinkEl.style.display = 'none';
            }

            if (currentBookData.trailer2) {
                trailerLinkEl2.onclick = function(e) {
                    e.preventDefault();
                    openVideo(currentBookData.trailer2, currentBookData.title + ' - Booktrailer Comprimido');
                };
                trailerLinkEl2.style.display = 'inline-flex';
            } else {
                trailerLinkEl2.style.display = 'none';
            }
        }

        function updateCarousel() {
            var covers = document.querySelectorAll('.book-cover');
            var indicators = document.querySelectorAll('.indicator');
            
            covers.forEach(function(cover, index) {
                cover.className = 'book-cover';
                var diff = index - currentBook;
                
                if (Math.abs(diff) > totalBooks / 2) {
                    diff = diff > 0 ? diff - totalBooks : diff + totalBooks;
                }

                switch (diff) {
                    case 0: 
                        cover.classList.add('active'); 
                        break;
                    case 1: 
                        cover.classList.add('next'); 
                        break;
                    case -1: 
                        cover.classList.add('prev'); 
                        break;
                    default: 
                        cover.classList.add(diff > 0 ? 'hidden-next' : 'hidden'); 
                        break;
                }
            });
            
            indicators.forEach(function(indicator, index) {
                if (index === currentBook) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            });

            updateBookInfo();
        }

        function nextBook() {
            currentBook = (currentBook + 1) % totalBooks;
            updateCarousel();
        }

        function prevBook() {
            currentBook = (currentBook - 1 + totalBooks) % totalBooks;
            updateCarousel();
        }

        function goToBook(index) {
            currentBook = index;
            updateCarousel();
        }

        function startAutoplay() {
            if (autoplayInterval) clearInterval(autoplayInterval);
            autoplayInterval = setInterval(nextBook, 4000);
        }

        function stopAutoplay() {
            clearInterval(autoplayInterval);
        }

        function toggleAutoplay() {
            isAutoplayActive = !isAutoplayActive;
            var btn = document.getElementById('autoplayBtn');
            
            if (isAutoplayActive) {
                startAutoplay();
                btn.textContent = '⏸️ Pausar Carrusel';
            } else {
                stopAutoplay();
                btn.textContent = '▶️ Reanudar Carrusel';
            }
        }

        // Funciones de video
        function openVideo(videoSrc, title) {
            var modal = document.getElementById('videoModal');
            var videoTitle = document.getElementById('videoTitle');
            var videoSource = document.getElementById('videoSource');
            var videoSourceWebm = document.getElementById('videoSourceWebm');
            var videoSourceOgv = document.getElementById('videoSourceOgv');
            var videoPlayer = document.getElementById('videoPlayer');
            var videoFallback = document.getElementById('videoFallback');
            var downloadLink = document.getElementById('videoDownloadLink');
            var directLink = document.getElementById('videoDirectLink');

            videoTitle.textContent = '🎬 ' + title;
            
            // Configurar múltiples fuentes de video
            videoSource.src = videoSrc;
            videoSourceWebm.src = videoSrc.replace('.mp4', '.webm');
            videoSourceOgv.src = videoSrc.replace('.mp4', '.ogv');
            
            // Configurar enlaces de fallback
            downloadLink.href = videoSrc;
            downloadLink.download = title + '.mp4';
            directLink.href = videoSrc;
            
            // Resetear el video
            videoPlayer.load();
            videoFallback.style.display = 'none';
            videoPlayer.style.display = 'block';

            // Variables para detectar problemas de reproducción
            var hasVideoData = false;
            var playbackStarted = false;

            // Manejar errores de carga
            videoPlayer.onerror = function() {
                console.log('Error cargando video:', videoSrc);
                videoPlayer.style.display = 'none';
                videoFallback.style.display = 'block';
            };

            videoPlayer.onloadeddata = function() {
                console.log('Video cargado correctamente');
                hasVideoData = true;
                videoFallback.style.display = 'none';
                videoPlayer.style.display = 'block';
            };

            // Detectar si el video tiene dimensiones válidas
            videoPlayer.onloadedmetadata = function() {
                console.log('Metadatos cargados - Dimensiones:', videoPlayer.videoWidth, 'x', videoPlayer.videoHeight);
                if (videoPlayer.videoWidth === 0 || videoPlayer.videoHeight === 0) {
                    console.log('Video sin dimensiones válidas - mostrando fallback');
                    videoPlayer.style.display = 'none';
                    videoFallback.style.display = 'block';
                }
            };

            // Detectar si realmente está reproduciendo
            videoPlayer.ontimeupdate = function() {
                if (!playbackStarted && videoPlayer.currentTime > 0) {
                    playbackStarted = true;
                    console.log('Reproducción iniciada correctamente');
                }
            };

            // Timeout más agresivo para detectar problemas
            setTimeout(function() {
                if (videoPlayer.readyState === 0 || !hasVideoData) {
                    console.log('Video no se pudo cargar después de 3 segundos - mostrando fallback');
                    videoPlayer.style.display = 'none';
                    videoFallback.style.display = 'block';
                }
            }, 3000);

            // Timeout adicional para detectar video "fantasma" (carga pero no se ve)
            setTimeout(function() {
                if (hasVideoData && videoPlayer.currentTime > 0 && (videoPlayer.videoWidth === 0 || videoPlayer.videoHeight === 0)) {
                    console.log('Video detectado como "fantasma" - tiene audio pero no video visible');
                    videoPlayer.style.display = 'none';
                    videoFallback.style.display = 'block';
                }
            }, 8000);

            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            // Intentar reproducir automáticamente
            setTimeout(function() {
                if (videoPlayer.readyState >= 2) {
                    videoPlayer.play().catch(function(error) {
                        console.log('Autoplay no permitido:', error);
                    });
                }
            }, 1000);
        }

        function closeVideo() {
            var modal = document.getElementById('videoModal');
            var videoPlayer = document.getElementById('videoPlayer');
            
            videoPlayer.pause();
            videoPlayer.currentTime = 0;
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            // Crear indicadores del carrusel
            var indicatorsContainer = document.getElementById('indicators');
            for (var i = 0; i < totalBooks; i++) {
                var indicator = document.createElement('div');
                indicator.classList.add('indicator');
                indicator.onclick = (function(index) {
                    return function() { goToBook(index); };
                })(i);
                indicatorsContainer.appendChild(indicator);
            }

            updateCarousel();
            startAutoplay();
            
            // Iniciar animación de texto destacado
            startHighlightAnimation();
            
            // Pausar autoplay al hacer hover en el carrusel
            var carousel = document.querySelector('.books-carousel');
            if (carousel) {
                carousel.addEventListener('mouseenter', stopAutoplay);
                carousel.addEventListener('mouseleave', function() { 
                    if (isAutoplayActive) startAutoplay(); 
                });
            }

            // Cerrar modales con ESC o clic fuera
            document.addEventListener('keydown', function(e) { 
                if (e.key === 'Escape') {
                    closeVideo();
                    closeGallery();
                    closeImageModal();
                } else if (e.key === 'ArrowLeft') {
                    navigateImage(-1);
                } else if (e.key === 'ArrowRight') {
                    navigateImage(1);
                }
            });
            
            document.getElementById('videoModal').addEventListener('click', function(e) { 
                if (e.target === this) closeVideo(); 
            });

            document.getElementById('galleryModal').addEventListener('click', function(e) { 
                if (e.target === this) closeGallery(); 
            });

            document.getElementById('imageModal').addEventListener('click', function(e) { 
                if (e.target === this) closeImageModal(); 
            });
        });

        // Función para animación de texto destacado
        function startHighlightAnimation() {
            var parts = document.querySelectorAll('.highlight-text .part');
            var currentIndex = 0;
            
            function highlightNext() {
                // Remover highlight de todos
                parts.forEach(function(part) {
                    part.classList.remove('highlight');
                });
                
                // Añadir highlight al actual
                if (parts[currentIndex]) {
                    parts[currentIndex].classList.add('highlight');
                }
                
                // Avanzar al siguiente
                currentIndex = (currentIndex + 1) % parts.length;
            }
            
            // Comenzar inmediatamente
            highlightNext();
            
            // Continuar cada 2 segundos
            setInterval(highlightNext, 2000);
        }
    </script>
</body>
</html>
